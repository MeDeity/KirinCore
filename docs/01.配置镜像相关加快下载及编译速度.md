# 01. 配置镜像相关加快下载及编译速度

## 概述

在 Android 项目开发中，由于网络环境和地理位置的因素，从默认仓库下载依赖库和插件可能会非常缓慢，甚至失败。通过配置国内镜像源，可以显著加快下载速度，提高开发效率。

## 镜像源配置

### 1. 阿里云云效仓库

**官方地址**: https://maven.aliyun.com/mvn/guide

**配置位置**: `settings.gradle` 中的 `pluginManagement` 和 `dependencyResolutionManagement` 块

```gradle
maven { url 'https://maven.aliyun.com/repository/central' }
```

**特点**:
- 同步频率高，更新及时
- 包含 Maven Central、JCenter、Google 等主流仓库
- 国内访问速度快

### 2. 华为开源镜像

**官方地址**: https://mirrors.huaweicloud.com

**配置位置**: `settings.gradle` 中的 `pluginManagement` 和 `dependencyResolutionManagement` 块

```gradle
maven { url 'https://repo.huaweicloud.com/repository/maven' }
```

**特点**:
- 覆盖全面的开源镜像
- 网络稳定性好
- 适合作为备用镜像源

### 3. JitPack 仓库

**官方地址**: https://jitpack.io

**配置位置**: `settings.gradle` 中的 `pluginManagement` 和 `dependencyResolutionManagement` 块

```gradle
maven { url "https://jitpack.io" }
```

**特点**:
- 专门用于 GitHub 项目的依赖发布
- 很多开源库通过此方式分发

## 完整配置示例

以下是 `settings.gradle.kts` 文件的完整镜像配置：

```gradle
pluginManagement {
    repositories {
        google {
            content {
                includeGroupByRegex("com\\.android.*")
                includeGroupByRegex("com\\.google.*")
                includeGroupByRegex("androidx.*")
            }
        }
        mavenCentral()
        gradlePluginPortal()
        maven {
            url = uri("https://maven.aliyun.com/repository/central")
        }
        maven {
            url = uri("https://repo.huaweicloud.com/repository/maven")
        }
        maven {
            url = uri("https://jitpack.io")
        }
    }
}
dependencyResolutionManagement {
    repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)
    repositories {
        google()
        mavenCentral()
        maven {
            url = uri("https://maven.aliyun.com/repository/central")
        }
        maven {
            url = uri("https://repo.huaweicloud.com/repository/maven")
        }
        maven {
            url = uri("https://jitpack.io")
        }
    }
}

rootProject.name = "KirinCore"
include(":app")
 
```

## 验证配置效果

配置完成后，可以通过以下命令验证下载速度：

```bash
./gradlew build --refresh-dependencies
```

观察依赖下载速度是否明显提升。

## 注意事项

1. **镜像同步延迟**: 国内镜像可能存在一定的同步延迟，如遇到依赖版本找不到的问题，可临时切换回官方源
2. **安全性**: 确保使用可信的镜像源，避免安全风险
3. **项目协作**: 在团队项目中统一镜像配置，确保构建环境一致性

通过以上配置，可以显著提升依赖下载速度和项目构建效率，为后续开发工作奠定良好基础。